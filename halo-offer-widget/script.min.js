!function(){"use strict";const config={cardsPerView:3,cardWidth:280,gap:24},state={currentCategory:"video",currentChip:"netflix",currentOffset:0,currentSlide:0,totalCards:0,maxOffset:0},elements={widget:document.querySelector("[data-hoffer-widget]"),tabsContainer:document.querySelector("[data-hoffer-tabs]"),chipsContainers:document.querySelectorAll("[data-hoffer-chips]"),background:document.querySelector("[data-hoffer-background]"),prevBtn:document.getElementById("hofferPrevBtn"),nextBtn:document.getElementById("hofferNextBtn"),pagination:document.getElementById("hofferPagination"),navArrows:document.querySelector(".hoffer-nav-arrows"),sliderContainer:document.querySelector(".hoffer-cards-container"),modal:document.getElementById("hofferSubscriptionModal"),modalBackdrop:document.getElementById("hofferModalBackdrop"),modalClose:document.getElementById("hofferModalClose"),modalSubscribeBtn:document.getElementById("hofferModalSubscribeBtn"),modalTitle:document.getElementById("hofferModalTitle"),modalTitlePrice:document.querySelector(".hoffer-modal-title-price"),modalTitleValidity:document.querySelector(".hoffer-modal-title-validity"),modalDataPlan:document.getElementById("hofferModalDataPlan"),modalPromoBadge:document.getElementById("hofferModalPromoBadge"),modalExpandable:document.getElementById("hofferModalExpandable")};function getActiveSlider(){const activeGroup=getActiveCardGroup();return activeGroup?activeGroup.querySelector("[data-hoffer-slider]"):null}function getCardWidth(){const activeSlider=getActiveSlider();if(activeSlider){const card=activeSlider.querySelector(".hoffer-package-card");if(card)return card.offsetWidth}const card=document.querySelector(".hoffer-package-card");return card?card.offsetWidth:config.cardWidth}function getSlideWidth(){return getCardWidth()+config.gap}function getActiveCardGroup(){return document.querySelector(`.hoffer-card-group[data-category="${state.currentCategory}"][data-chip="${state.currentChip}"]`)}function initCategoryTabs(){const tabs=elements.tabsContainer.querySelectorAll(".hoffer-tab-item");tabs.forEach(tab=>{tab.addEventListener("click",function(){const category=this.dataset.category,background=this.dataset.background;tabs.forEach(t=>t.classList.remove("active")),this.classList.add("active"),state.currentCategory=category,state.currentOffset=0,state.currentSlide=0,updateBackground(background),updateChipsVisibility(category);const chipsContainer=document.querySelector(`[data-hoffer-chips][data-category="${category}"]`),firstChip=chipsContainer?.querySelector(".hoffer-chip");firstChip&&activateChip(firstChip.dataset.chip)})})}function updateBackground(backgroundPath){elements.background&&backgroundPath&&(elements.background.style.backgroundImage=`url('${backgroundPath}')`)}function updateChipsVisibility(category){elements.chipsContainers.forEach(container=>{container.dataset.category===category?container.classList.add("hoffer-active"):container.classList.remove("hoffer-active")})}function initChips(){document.querySelectorAll(".hoffer-chip").forEach(chip=>{chip.addEventListener("click",function(){activateChip(this.dataset.chip)})})}function activateChip(chipId){state.currentChip=chipId,state.currentOffset=0,state.currentSlide=0;const currentChipsContainer=document.querySelector(`[data-hoffer-chips][data-category="${state.currentCategory}"]`);currentChipsContainer&&currentChipsContainer.querySelectorAll(".hoffer-chip").forEach(chip=>{chip.classList.toggle("active",chip.dataset.chip===chipId)}),updateCardGroupsVisibility(),updateSlider()}function updateCardGroupsVisibility(){const cardGroups=document.querySelectorAll(".hoffer-card-group");cardGroups.forEach(group=>{const matchesCategory=group.dataset.category===state.currentCategory,matchesChip=group.dataset.chip===state.currentChip;matchesCategory&&matchesChip?group.classList.add("hoffer-active"):group.classList.remove("hoffer-active")});const activeGroup=getActiveCardGroup();state.totalCards=activeGroup?activeGroup.querySelectorAll(".hoffer-package-card").length:0}function updateSlider(){const slideWidth=getSlideWidth(),containerWidth=elements.sliderContainer?.offsetWidth||900;config.cardsPerView=containerWidth<600?1:containerWidth<900?2:3;const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.maxOffset=slideWidth*(totalSlides-1);const allSliders=document.querySelectorAll("[data-hoffer-slider]"),activeSlider=getActiveSlider();allSliders.forEach(slider=>{slider===activeSlider?slider.style.transform=`translateX(-${state.currentOffset}px)`:slider.style.transform="translateX(0)"});const isAtFirstSlide=state.currentSlide<=0,isAtLastSlide=state.currentSlide>=totalSlides-1||state.totalCards<=config.cardsPerView;elements.prevBtn&&(elements.prevBtn.disabled=isAtFirstSlide),elements.nextBtn&&(elements.nextBtn.disabled=isAtLastSlide),updatePagination(),updateNavigationVisibility()}function updatePagination(){if(!elements.pagination)return;const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);elements.pagination.innerHTML="";for(let i=0;i<totalSlides;i++){const dot=document.createElement("div");dot.className="hoffer-pagination-dot"+(i===state.currentSlide?" active":""),dot.style.width=i===state.currentSlide?"32px":"8px",dot.style.height="8px",dot.addEventListener("click",()=>goToSlide(i)),elements.pagination.appendChild(dot)}}function updateNavigationVisibility(){const isMobile=window.innerWidth<=768,totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);elements.navArrows&&(state.totalCards<=3||totalSlides<=1||isMobile?elements.navArrows.style.display="none":elements.navArrows.style.display="flex"),elements.pagination&&(state.totalCards<=3||isMobile||totalSlides<=1?elements.pagination.style.display="none":elements.pagination.style.display="flex")}function goToSlide(index){const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.currentSlide=Math.max(0,Math.min(index,totalSlides-1));const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function slidePrev(){state.currentSlide=Math.max(0,state.currentSlide-1);const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function slideNext(){const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.currentSlide=Math.min(state.currentSlide+1,totalSlides-1);const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}let touchState={startX:0,currentX:0,startOffset:0,isDragging:!1};function initTouchSupport(){const container=elements.sliderContainer;container&&(container.addEventListener("touchstart",handleTouchStart,{passive:!0}),container.addEventListener("touchmove",handleTouchMove,{passive:!0}),container.addEventListener("touchend",handleTouchEnd,{passive:!0}),container.addEventListener("touchcancel",handleTouchCancel,{passive:!0}))}function handleTouchStart(e){touchState.startX=e.touches[0].clientX,touchState.currentX=touchState.startX,touchState.startOffset=state.currentOffset,touchState.isDragging=!0;const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="none")}function handleTouchMove(e){if(!touchState.isDragging)return;touchState.currentX=e.touches[0].clientX;const diff=touchState.startX-touchState.currentX;let newOffset=touchState.startOffset+diff;if(newOffset<0)newOffset=.3*diff;else if(newOffset>state.maxOffset){const beyondEnd=newOffset-state.maxOffset;newOffset=state.maxOffset+.3*beyondEnd}const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transform=`translateX(-${newOffset}px)`)}function handleTouchEnd(e){if(!touchState.isDragging)return;touchState.isDragging=!1;const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="transform 0.5s ease");const touchEndX=e.changedTouches[0].clientX,diff=touchState.startX-touchEndX,slideWidth=getSlideWidth(),totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1),draggedOffset=touchState.startOffset+diff;let targetSlide=Math.round(draggedOffset/slideWidth);const velocity=diff/(Date.now()-e.timeStamp);Math.abs(velocity)>.5&&(targetSlide=velocity>0?Math.min(targetSlide+1,totalSlides-1):Math.max(targetSlide-1,0)),targetSlide=Math.max(0,Math.min(targetSlide,totalSlides-1)),state.currentSlide=targetSlide,state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function handleTouchCancel(){touchState.isDragging&&(touchState.isDragging=!1);const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="transform 0.5s ease"),updateSlider()}function initModal(){if(!elements.modal)return;elements.modalBackdrop&&elements.modalBackdrop.addEventListener("click",closeModal),elements.modalClose&&elements.modalClose.addEventListener("click",closeModal),elements.modalSubscribeBtn&&elements.modalSubscribeBtn.addEventListener("click",closeModal),elements.widget&&elements.widget.addEventListener("click",handleCardClick)}function handleCardClick(e){const card=e.target.closest(".hoffer-package-card");if(!card)return;let extraData=[];try{extraData=card.dataset.extra?JSON.parse(card.dataset.extra):[]}catch(error){extraData=[{key:"INTERNET",value:card.dataset.extra||""}]}const cardData={name:card.dataset.name||"",duration:card.dataset.duration||"",extra:extraData,originalPrice:card.dataset.originalPrice||"",finalPrice:card.dataset.finalPrice||"",promo:card.dataset.promo||"",expandable:[],href:card.dataset.href||"#"};try{cardData.expandable=card.dataset.expandable?JSON.parse(card.dataset.expandable):[]}catch(error){cardData.expandable=[]}openModal(cardData)}function openModal(cardData){if(!elements.modal)return;elements.modalSubscribeBtn&&(elements.modalSubscribeBtn.href=cardData.href),elements.modalPromoBadge.style.display="flex",elements.modalTitle&&(elements.modalTitle.textContent=cardData.name),elements.modalTitlePrice&&(elements.modalTitlePrice.textContent=cardData.finalPrice),elements.modalTitleValidity&&(elements.modalTitleValidity.textContent=cardData.duration),renderDataPlanRows(cardData.extra),elements.modalPromoBadge&&(cardData.promo?elements.modalPromoBadge.textContent=cardData.promo:elements.modalPromoBadge.style.display="none"),renderExpandableSections(cardData.expandable),document.querySelectorAll(".hoffer-expandable-section").forEach(section=>{section.classList.remove("active")}),elements.modal.classList.add("active"),document.body.style.overflow="hidden"}function renderDataPlanRows(extraData){if(!elements.modalDataPlan)return;elements.modalDataPlan.innerHTML="",extraData&&0!==extraData.length||(extraData=[{icon:"assets/components/globe.svg",key:"INTERNET",value:"-"}]),extraData.forEach(item=>{const iconSrc=item.icon||"assets/components/globe.svg",rowHtml=`\n                <div class="hoffer-data-plan-row">\n                    <div class="hoffer-data-plan-label">\n                        <img src="${iconSrc}" alt="icon-offer">\n                        <span>${item.key}</span>\n                    </div>\n                    <span class="hoffer-data-plan-value">${item.value}</span>\n                </div>\n            `;elements.modalDataPlan.innerHTML+=rowHtml})}function renderExpandableSections(expandableData){if(!elements.modalExpandable)return;elements.modalExpandable.innerHTML="",expandableData&&0!==expandableData.length||(expandableData=[{title:"Informasi",content:"-"}]),expandableData.forEach((item,index)=>{const sectionHtml=`\n                <div class="hoffer-expandable-section">\n                    <button class="hoffer-expandable-header" data-expand-index="${index}">\n                        <span>${item.title||"Informasi"}</span>\n                        <svg class="hoffer-chevron" viewBox="0 0 24 24" fill="none"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>\n                    </button>\n                    <div class="hoffer-expandable-content">${item.content||"-"}</div>\n                </div>\n            `;elements.modalExpandable.innerHTML+=sectionHtml}),attachExpandableListeners()}function attachExpandableListeners(){const headers=document.querySelectorAll(".hoffer-expandable-header");headers.forEach(header=>{header.addEventListener("click",function(){const section=this.closest(".hoffer-expandable-section"),isCurrentlyActive=section.classList.contains("active");document.querySelectorAll(".hoffer-expandable-section").forEach(s=>{s.classList.remove("active")}),isCurrentlyActive||section.classList.add("active")})})}function getExtraDisplayText(extraData){if(!extraData||0===extraData.length)return"";if(1===extraData.length)return extraData[0].value;if(2===extraData.length)return`${extraData[0].value} + ${extraData[1].value}`;return`${extraData[0].value} + ${extraData.length-1} more`}function initCardDisplays(){document.querySelectorAll(".hoffer-package-card").forEach(card=>{const extraElement=card.querySelector(".hoffer-package-extra");if(!extraElement)return;try{card.dataset.extra?JSON.parse(card.dataset.extra):[]}catch(error){return}})}function closeModal(){elements.modal&&(elements.modal.classList.remove("active"),document.body.style.overflow="",document.querySelectorAll(".hoffer-expandable-section").forEach(section=>{section.classList.remove("active")}))}function initKeyboardNavigation(){document.addEventListener("keydown",e=>{"Escape"===e.key&&elements.modal&&elements.modal.classList.contains("active")&&closeModal(),"ArrowLeft"===e.key&&elements.prevBtn&&!elements.prevBtn.disabled&&slidePrev(),"ArrowRight"===e.key&&elements.nextBtn&&!elements.nextBtn.disabled&&slideNext()})}function initResizeHandler(){window.addEventListener("resize",()=>{const slideWidth=getSlideWidth(),totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.maxOffset=slideWidth*(totalSlides-1),state.currentSlide=Math.round(state.currentOffset/slideWidth),state.currentSlide>totalSlides-1&&(state.currentSlide=Math.max(0,totalSlides-1)),state.currentOffset=state.currentSlide*slideWidth,updateSlider()})}function init(){initCategoryTabs(),initChips(),initTouchSupport(),initModal(),initKeyboardNavigation(),initResizeHandler(),elements.prevBtn&&elements.prevBtn.addEventListener("click",slidePrev),elements.nextBtn&&elements.nextBtn.addEventListener("click",slideNext),initCardDisplays(),updateCardGroupsVisibility(),updateSlider();const firstTab=elements.tabsContainer?.querySelector(".hoffer-tab-item[data-background]");firstTab&&updateBackground(firstTab.dataset.background)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init()}();
