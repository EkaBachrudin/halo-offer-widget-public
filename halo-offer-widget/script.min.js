!function(){"use strict";const config={cardsPerView:3,cardWidth:280,gap:24};let state={currentCategory:"video",currentChip:"netflix",currentOffset:0,currentSlide:0,totalCards:0,maxOffset:0};const elements={widget:document.querySelector("[data-hoffer-widget]"),tabsContainer:document.querySelector("[data-hoffer-tabs]"),chipsContainers:document.querySelectorAll("[data-hoffer-chips]"),background:document.querySelector("[data-hoffer-background]"),prevBtn:document.getElementById("hofferPrevBtn"),nextBtn:document.getElementById("hofferNextBtn"),pagination:document.getElementById("hofferPagination"),navArrows:document.querySelector(".hoffer-nav-arrows"),sliderContainer:document.querySelector(".hoffer-cards-container"),modal:document.getElementById("hofferSubscriptionModal"),modalBackdrop:document.getElementById("hofferModalBackdrop"),modalClose:document.getElementById("hofferModalClose"),modalSubscribeBtn:document.getElementById("hofferModalSubscribeBtn"),modalTitle:document.getElementById("hofferModalTitle"),modalTitlePrice:document.querySelector(".hoffer-modal-title-price"),modalTitleValidity:document.querySelector(".hoffer-modal-title-validity"),modalDataPlan:document.getElementById("hofferModalDataPlan"),modalPromoBadge:document.getElementById("hofferModalPromoBadge"),modalDetails:document.getElementById("hofferModalDetails"),modalTerms:document.getElementById("hofferModalTerms")};function getActiveSlider(){const activeGroup=getActiveCardGroup();return activeGroup?activeGroup.querySelector("[data-hoffer-slider]"):null}function getSlideWidth(){return function(){const activeSlider=getActiveSlider();if(activeSlider){const card=activeSlider.querySelector(".hoffer-package-card");if(card)return card.offsetWidth}const card=document.querySelector(".hoffer-package-card");return card?card.offsetWidth:config.cardWidth}()+config.gap}function getActiveCardGroup(){return document.querySelector(`.hoffer-card-group[data-category="${state.currentCategory}"][data-chip="${state.currentChip}"]`)}function initCategoryTabs(){const tabs=elements.tabsContainer.querySelectorAll(".hoffer-tab-item");tabs.forEach(tab=>{tab.addEventListener("click",function(){const category=this.dataset.category,background=this.dataset.background;tabs.forEach(t=>t.classList.remove("active")),this.classList.add("active"),state.currentCategory=category,state.currentOffset=0,state.currentSlide=0,updateBackground(background),function(category){elements.chipsContainers.forEach(container=>{container.dataset.category===category?container.classList.add("hoffer-active"):container.classList.remove("hoffer-active")})}(category);const chipsContainer=document.querySelector(`[data-hoffer-chips][data-category="${category}"]`),firstChip=chipsContainer?.querySelector(".hoffer-chip");firstChip&&activateChip(firstChip.dataset.chip)})})}function updateBackground(backgroundPath){elements.background&&backgroundPath&&(elements.background.style.backgroundImage=`url('${backgroundPath}')`)}function activateChip(chipId){state.currentChip=chipId,state.currentOffset=0,state.currentSlide=0;const currentChipsContainer=document.querySelector(`[data-hoffer-chips][data-category="${state.currentCategory}"]`);currentChipsContainer&&currentChipsContainer.querySelectorAll(".hoffer-chip").forEach(chip=>{chip.classList.toggle("active",chip.dataset.chip===chipId)}),updateCardGroupsVisibility(),updateSlider()}function updateCardGroupsVisibility(){document.querySelectorAll(".hoffer-card-group").forEach(group=>{const matchesCategory=group.dataset.category===state.currentCategory,matchesChip=group.dataset.chip===state.currentChip;matchesCategory&&matchesChip?group.classList.add("hoffer-active"):group.classList.remove("hoffer-active")});const activeGroup=getActiveCardGroup();state.totalCards=activeGroup?activeGroup.querySelectorAll(".hoffer-package-card").length:0}function updateSlider(){const slideWidth=getSlideWidth(),containerWidth=elements.sliderContainer?.offsetWidth||900;config.cardsPerView=containerWidth<600?1:containerWidth<900?2:3;const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.maxOffset=slideWidth*(totalSlides-1);const allSliders=document.querySelectorAll("[data-hoffer-slider]"),activeSlider=getActiveSlider();allSliders.forEach(slider=>{slider.style.transform=slider===activeSlider?`translateX(-${state.currentOffset}px)`:"translateX(0)"});const isAtFirstSlide=state.currentSlide<=0,isAtLastSlide=state.currentSlide>=totalSlides-1||state.totalCards<=config.cardsPerView;elements.prevBtn&&(elements.prevBtn.disabled=isAtFirstSlide),elements.nextBtn&&(elements.nextBtn.disabled=isAtLastSlide),function(){if(!elements.pagination)return;const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);elements.pagination.innerHTML="";for(let i=0;i<totalSlides;i++){const dot=document.createElement("div");dot.className="hoffer-pagination-dot"+(i===state.currentSlide?" active":""),dot.style.width=i===state.currentSlide?"32px":"8px",dot.style.height="8px",dot.addEventListener("click",()=>goToSlide(i)),elements.pagination.appendChild(dot)}}(),function(){const isMobile=window.innerWidth<=768,totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);elements.navArrows&&(state.totalCards<=3||totalSlides<=1||isMobile?elements.navArrows.style.display="none":elements.navArrows.style.display="flex");elements.pagination&&(state.totalCards<=3||isMobile||totalSlides<=1?elements.pagination.style.display="none":elements.pagination.style.display="flex")}()}function goToSlide(index){const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.currentSlide=Math.max(0,Math.min(index,totalSlides-1));const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function slidePrev(){state.currentSlide=Math.max(0,state.currentSlide-1);const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function slideNext(){const totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.currentSlide=Math.min(state.currentSlide+1,totalSlides-1);const slideWidth=getSlideWidth();state.currentOffset=state.currentSlide*slideWidth,updateSlider()}let touchState={startX:0,currentX:0,startOffset:0,isDragging:!1};function handleTouchStart(e){touchState.startX=e.touches[0].clientX,touchState.currentX=touchState.startX,touchState.startOffset=state.currentOffset,touchState.isDragging=!0;const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="none")}function handleTouchMove(e){if(!touchState.isDragging)return;touchState.currentX=e.touches[0].clientX;const diff=touchState.startX-touchState.currentX;let newOffset=touchState.startOffset+diff;if(newOffset<0)newOffset=.3*diff;else if(newOffset>state.maxOffset){const beyondEnd=newOffset-state.maxOffset;newOffset=state.maxOffset+.3*beyondEnd}const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transform=`translateX(-${newOffset}px)`)}function handleTouchEnd(e){if(!touchState.isDragging)return;touchState.isDragging=!1;const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="transform 0.5s ease");const touchEndX=e.changedTouches[0].clientX,diff=touchState.startX-touchEndX,slideWidth=getSlideWidth(),totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1),draggedOffset=touchState.startOffset+diff;let targetSlide=Math.round(draggedOffset/slideWidth);const velocity=diff/(Date.now()-e.timeStamp);Math.abs(velocity)>.5&&(targetSlide=velocity>0?Math.min(targetSlide+1,totalSlides-1):Math.max(targetSlide-1,0)),targetSlide=Math.max(0,Math.min(targetSlide,totalSlides-1)),state.currentSlide=targetSlide,state.currentOffset=state.currentSlide*slideWidth,updateSlider()}function handleTouchCancel(){if(!touchState.isDragging)return;touchState.isDragging=!1;const activeSlider=getActiveSlider();activeSlider&&(activeSlider.style.transition="transform 0.5s ease"),updateSlider()}function handleCardClick(e){const card=e.target.closest(".hoffer-package-card");if(!card)return;let extraData=[];try{extraData=card.dataset.extra?JSON.parse(card.dataset.extra):[]}catch(error){console.warn("Failed to parse data-extra JSON:",error),extraData=[{key:"INTERNET",value:card.dataset.extra||""}]}!function(cardData){if(!elements.modal)return;elements.modalSubscribeBtn&&(elements.modalSubscribeBtn.href=cardData.href);elements.modalPromoBadge.style.display="flex",elements.modalTitle&&(elements.modalTitle.textContent=cardData.name);elements.modalTitlePrice&&(elements.modalTitlePrice.textContent=cardData.finalPrice);elements.modalTitleValidity&&(elements.modalTitleValidity.textContent=cardData.duration);(function(extraData){if(!elements.modalDataPlan)return;elements.modalDataPlan.innerHTML="",extraData&&0!==extraData.length||(extraData=[{icon:"assets/components/globe.svg",key:"INTERNET",value:"-"}]);extraData.forEach(item=>{const rowHtml=`\n                <div class="hoffer-data-plan-row">\n                    <div class="hoffer-data-plan-label">\n                        <img src="${item.icon||"assets/components/globe.svg"}" alt="icon-offer">\n                        <span>${item.key}</span>\n                    </div>\n                    <span class="hoffer-data-plan-value">${item.value}</span>\n                </div>\n            `;elements.modalDataPlan.innerHTML+=rowHtml})})(cardData.extra),elements.modalPromoBadge&&(cardData.promo?elements.modalPromoBadge.textContent=cardData.promo:elements.modalPromoBadge.style.display="none");elements.modalDetails&&(cardData.details?elements.modalDetails.innerHTML=cardData.details:elements.modalDetails.innerHTML="-");elements.modalTerms&&(cardData.terms?elements.modalTerms.innerHTML=cardData.terms:elements.modalTerms.innerHTML="-");document.querySelectorAll(".hoffer-expandable-section").forEach(section=>{section.classList.remove("active")}),elements.modal.classList.add("active"),document.body.style.overflow="hidden"}({name:card.dataset.name||"",duration:card.dataset.duration||"",extra:extraData,originalPrice:card.dataset.originalPrice||"",finalPrice:card.dataset.finalPrice||"",promo:card.dataset.promo||"",details:card.dataset.details||"",terms:card.dataset.terms||"",href:card.dataset.href||"#"})}function closeModal(){elements.modal&&(elements.modal.classList.remove("active"),document.body.style.overflow="",document.querySelectorAll(".hoffer-expandable-section").forEach(section=>{section.classList.remove("active")}))}function init(){initCategoryTabs(),document.querySelectorAll(".hoffer-chip").forEach(chip=>{chip.addEventListener("click",function(){activateChip(this.dataset.chip)})}),function(){const container=elements.sliderContainer;container&&(container.addEventListener("touchstart",handleTouchStart,{passive:!0}),container.addEventListener("touchmove",handleTouchMove,{passive:!0}),container.addEventListener("touchend",handleTouchEnd,{passive:!0}),container.addEventListener("touchcancel",handleTouchCancel,{passive:!0}))}(),elements.modal&&(elements.modalBackdrop&&elements.modalBackdrop.addEventListener("click",closeModal),elements.modalClose&&elements.modalClose.addEventListener("click",closeModal),elements.modalSubscribeBtn&&elements.modalSubscribeBtn.addEventListener("click",closeModal),document.querySelectorAll(".hoffer-expandable-header").forEach(header=>{header.addEventListener("click",function(){const section=this.closest(".hoffer-expandable-section"),isCurrentlyActive=section.classList.contains("active");document.querySelectorAll(".hoffer-expandable-section").forEach(s=>{s.classList.remove("active")}),isCurrentlyActive||section.classList.add("active")})}),document.querySelectorAll("[data-hoffer-slider]").forEach(slider=>{slider.addEventListener("click",handleCardClick)})),document.addEventListener("keydown",e=>{"Escape"===e.key&&elements.modal?.classList.contains("active")?closeModal():"ArrowLeft"===e.key&&elements.prevBtn&&!elements.prevBtn.disabled?slidePrev():"ArrowRight"===e.key&&elements.nextBtn&&!elements.nextBtn.disabled&&slideNext()}),window.addEventListener("resize",()=>{const slideWidth=getSlideWidth(),totalSlides=Math.max(1,state.totalCards-config.cardsPerView+1);state.maxOffset=slideWidth*(totalSlides-1),state.currentSlide=Math.round(state.currentOffset/slideWidth),state.currentSlide>totalSlides-1&&(state.currentSlide=Math.max(0,totalSlides-1)),state.currentOffset=state.currentSlide*slideWidth,updateSlider()}),elements.prevBtn&&elements.prevBtn.addEventListener("click",slidePrev),elements.nextBtn&&elements.nextBtn.addEventListener("click",slideNext),document.querySelectorAll(".hoffer-package-card").forEach(card=>{if(!card.querySelector(".hoffer-package-extra"))return;let extraData=[];try{extraData=card.dataset.extra?JSON.parse(card.dataset.extra):[]}catch(error){return}}),updateCardGroupsVisibility(),updateSlider();const firstTab=elements.tabsContainer?.querySelector(".hoffer-tab-item[data-background]");firstTab&&updateBackground(firstTab.dataset.background)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init()}();